<%inherit file="base.html" />
<%!
   import time
   import dateutil.parser
   from datetime import datetime

   now = datetime.now()
%>

<%! from django.core.urlresolvers import reverse %>
<%block name="bodyclass">subsection</%block>
<%block name="title">CMS Subsection</%block>

<%namespace name="units" file="widgets/units.html" />
<%namespace name='static' file='static_content.html'/>
<%namespace name='datetime' module='datetime'/>

<%block name="content">
<div class="main-wrapper">
  <div class="inner-wrapper">
    <div class="main-column">
      <article class="subsection-body window">
	<div class="subsection-name-input">
	  <label>Display Name:</label>
	  <input type="text" value="${subsection.metadata['display_name']}" class="subsection-display-name-input" data-metadata-name="display_name"/>
	</div>
	<div>
	  <label>Format:</label>
	  <input type="text" value="${subsection.metadata['format'] if 'format' in subsection.metadata else ''}" class="unit-subtitle" data-metadata-name="subtitle"/>
	</div>
	<div class="unit-list">
	  <label>Units:</label>
	  ${units.enum_units(subsection)}
	</div>
	<div>
	  <label>Policy:</label>
	  <textarea class="text-editor">Policy blah, blah, blah…</textarea>
	</div>					
      </article>
    </div>

    <div class="sidebar">
      <div class="unit-properties window">
	<h4>Subsection Settings</h4>
	<div class="window-contents">
	  <div class="scheduled-date-input row">
	    <label>Release date:<!-- <span class="description">Determines when this subsection and the units within it will be released publicly.</span>--></label>
	    <div class="datepair" data-language="javascript">
	      <input type="text" value="${subsection.start.strftime('%Y-%m-%d') if subsection.start is not None else ''}" placeholder="MM/DD/YYYY" class="date" size='15'/>
	      <input type="text" value="${subsection.start.strftime('%H:%M') if subsection.start is not None else ''}" placeholder="HH:MM" class="time" size='10'/> 
	    </div>
	    <p class="notice">The date above differs from the release date of Week 1 – 10/10/2012 at 12:00 am. <a href="#" class="sync-date">Sync to Week 1.</a></p>
	  </div>
	<div class="due-date-input row">
	  <label>Due date:</label>
	  <a href="#" class="set-date">Set a due date</a>
	  <div class="datepair date-setter">
	    <p class="date-description">
	      <%
		 due_date = dateutil.parser.parse(subsection.metadata.get('get')) if 'due' in subsection.metadata else None
		 %>
	      <input type="text" value="${due_date.strftime('%Y-%m-%d') if due_date is not None else ''}" placeholder="MM/DD/YYYY" class="date" size='15' /> 
	      <input type="text" value="${due_date.strftime('%H:%M') if due_date is not None else ''}" placeholder="HH:MM" class="time" size='10' />
	      <a href="#" class="remove-date">Remove due date</a>
	    </p>
	  </div>
	</div>
	<div class="row unit-actions">
	  <a href="#" class="save-button save-subsection" data-id="${subsection.location}">Save</a>
	  <a href="${lms_link}" target="_blank" class="preview-button">Preview</a>
	</div>
      </div>
    </div>
  </div>
</div>
</%block>

<%block name="jsextra">
<link rel="stylesheet" type="text/css" href="${static.url('js/vendor/timepicker/jquery.timepicker.css')}" />
<script src="${static.url('js/vendor/timepicker/jquery.timepicker.js')}"></script>
<script src="${static.url('js/vendor/timepicker/datepair.js')}"></script>
</%block>
