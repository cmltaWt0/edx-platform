<%! from django.utils.translation import ugettext as _ %>

<%
  import hashlib
  import copy
  import json
  hlskey = hashlib.md5(module.location.url()).hexdigest()
%>

<% showHighLevelSource='source_code' in editable_metadata_fields and editable_metadata_fields['source_code']['explicitly_set'] %>
<% metadata_field_copy = copy.deepcopy(editable_metadata_fields) %>
## Delete 'source_code' field (if it exists) so metadata editor view does not attempt to render it.
% if 'source_code' in editable_metadata_fields:
    ## source-edit.html needs access to the 'source_code' value, so delete from a copy.
    <% del metadata_field_copy['source_code'] %>
% endif

% if showHighLevelSource:
    <div class="launch-latex-compiler">
      <a href="#hls-modal-${hlskey}" id="hls-trig-${hlskey}">${_("Launch Latex Source Compiler")}</a>
    </div>
    <%include file="source-edit.html" />
% endif

<div class="wrapper-comp-settings metadata_edit" id="settings-tab" data-metadata='${json.dumps(metadata_field_copy)}'/>