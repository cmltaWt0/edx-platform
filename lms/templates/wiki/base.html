{% extends "main_django.html" %}
{% load compressed %}{% load sekizai_tags i18n %}{% load url from future %}{% load staticfiles %}

{% block title %}<title>{% block pagetitle %}{% endblock %} | edX Wiki</title>{% endblock %}

{% block headextra %}
  {% compressed_css 'course' %}
  
  <script type="text/javascript">
    function ajaxError(){}
    
    $.ajaxSetup({
      timeout: 7000,
      cache: false,
      error: function(e, xhr, settings, exception) {
          ajaxError();
      }
    });

    function jsonWrapper(url, callback) {
      $.getJSON(url, function(data) {
        if (data == null) {
          ajaxError();
        } else {
          callback(data);
        }
      });
    }
  </script>


  {% addtoblock 'js' %}
    {% comment %} These scripts load at the bottom of the body {% endcomment %}

    <script src="{% static 'js/bootstrap-alert.js' %}"></script>
    <script src="{% static 'js/bootstrap-collapse.js' %}"></script>
    <script src="{% static 'js/bootstrap-modal.js' %}"></script>

    {% with mathjax_mode='wiki' %}
      {% include "mathjax_include.html" %}
    {% endwith %}
    <script type="text/javascript">
	    $(document).ready(function () {
          editor = $('#div_id_content div.controls');
          cs = editor.prepend('<p class="cheatsheet">Markdown syntax is allowed. See the <a id="cheatsheetLink" href="#">cheatsheet</a> for help.</p>');
          cs.find('#cheatsheetLink').click(function() {
              $('#cheatsheetModal').modal('show');
          });
          $('#cheatsheetModal .close-btn').click(function(e) {
            $('#cheatsheetModal').modal('hide');
          });
	    });
    </script>
  {% endaddtoblock %}

{% endblock %}


{% block body %}
  {% if course %}
    {% include "courseware/course_navigation.html" with active_page_context="wiki" %}
  {% endif %}

  <section class="container wiki {{ selected_tab }}">
    <div class="wiki-wrapper">
      {% block wiki_body %}
        
        {% block wiki_breadcrumbs %}{% endblock %}

        {% if messages %}
          {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
              <a class="close" data-dismiss="alert" href="#">&times;</a>
              {{ message }}
            </div>
          {% endfor %}
        {% endif %}

        {% block wiki_contents %}{% endblock %}

      {% endblock %}
    </div>

    {% include "wiki/includes/cheatsheet.html" %}

  </section>

{% endblock %}
