## mako
<%inherit file="mako_base.html"/>

<%!
  from django.core.urlresolvers import reverse
  from mitxmako.templatetag_helpers import django_template_include
%>

<%namespace name="article_menu" file="includes/article_menu.html"/>
<%namespace name="breadcrumbs" file="includes/breadcrumbs.html"/>


<%block name="title"><title>Edit: ${article.current_revision.title}</title></%block>

<%block name="wiki_breadcrumbs">
${breadcrumbs.body(article, urlpath)}
</%block>


<%block name="wiki_contents">
  <div class="tabbable tabs-top" style="margin-top: 20px;">
    <ul class="nav nav-tabs">
      <li style="float: left">
        <h1 style="margin-top: -10px;">${article.current_revision.title}</h1>
      </li>
      ${article_menu.body('edit', article, plugins)}
    </ul>
  
    <div class="tab-content">
    <form method="POST" class="form-horizontal">
      ${django_template_include("wiki/includes/editor.html", context)}
      <div class="form-actions">
          <button type="submit" name="preview" value="1" class="btn btn-large" onclick="$('#previewModal').modal('show'); this.form.target='previewWindow'; this.form.action='${reverse('wiki:preview', kwargs={'path' : urlpath.path})}'">
            <span class="icon-eye-open"></span>
            Preview
          </button>
          <button type="submit" name="save" value="1" class="btn btn-large btn-primary" onclick="this.form.target=''; this.form.action='${reverse('wiki:edit', kwargs={'path' : urlpath.path})}'">
            <span class="icon-ok"></span>
            Save changes
          </button>
              
          <a class="pull-right btn btn-danger">
            <span class="icon-trash"></span>
            Delete article
          </a>
              
      </div>
      <div class="modal hide fade" id="previewModal" style="width: 80%; min-height: 500px; margin-left: -40%;">
        <div class="modal-body">
          <iframe name="previewWindow" style="width: 100%; min-height: 400px; border: 0;" frameborder="0"></iframe>
        </div>
        <div class="modal-footer">
          <a href="#" class="btn btn-large" data-dismiss="modal">
            <span class="icon-circle-arrow-left"></span>
            Back to editor
          </a>
          <button type="submit" name="save" value="1" class="btn btn-large btn-primary" onclick="this.form.target=''; this.form.action='${reverse('wiki:edit', kwargs={'path' : urlpath.path})}'">
            <span class="icon-ok"></span>
            Save changes
          </button>
        </div>
      </div>
             
    </form>
      
    </div>
  </div>

  <div class="tabbable tabs-below" style="margin-top: 20px;">
    <ul class="nav nav-tabs">
      ${article_menu.body('edit', article, plugins)}
      <li style="margin-top: 10px;"><em>Article last modified: ${ article.current_revision.modified }</em></li>
    </ul>
  </div>
</%block>


