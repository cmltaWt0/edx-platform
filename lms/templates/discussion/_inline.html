<%namespace name="renderer" file="_thread.html"/>
<%! from django.template.defaultfilters import escapejs %>

<section class="discussion inline-discussion" _id="${discussion_id}">

  <div class="discussion-non-content discussion-local">
    <form class="new-post-form collapsed" id="new-post-form" style="display: block; ">
      <ul class="discussion-errors"></ul>
      <div class="new-post-body reply-body"></div>
      <div class="post-options">
        <input type="checkbox" class="discussion-post-anonymously" id="discussion-post-anonymously-${discussion_id}">
        <label for="discussion-post-anonymously-${discussion_id}">post anonymously</label>
        <input type="checkbox" class="discussion-auto-watch" id="discussion-autowatch-${discussion_id}" checked="">
        <label for="discussion-auto-watch-${discussion_id}">follow this thread</label>
      </div>
      <div class="reply-post-control">        
        <a class="discussion-submit-post control-button" href="javascript:void(0)">Submit</a>
      </div>
    </form>
  </div>

  <div class="threads">
    % for thread in threads:
      ${renderer.render_thread(course_id, thread, show_comments=False)}
    % endfor
  </div>

  <%include file="_paginator.html" />
</section>

<script type="text/javascript">
  var $$user_info = JSON.parse("${user_info | escapejs}");
  var $$course_id = "${course_id | escapejs}";
  if (typeof $$annotated_content_info === undefined || $$annotated_content_info === null) {
    var $$annotated_content_info = {};
  }
  $$annotated_content_info = $.extend($$annotated_content_info, JSON.parse("${annotated_content_info | escapejs}"));
</script>
