<%! from django_comment_client.utils import pluralize %>
<%! from django_comment_client.permissions import has_permission, check_permissions_by_view %>

<%inherit file="../main.html" />
<%namespace name='static' file='../static_content.html'/>
<%block name="bodyclass">discussion</%block>
<%block name="title"><title>Discussion â€“ MITx 6.002x</title></%block>

<%block name="headextra">
<%static:css group='course'/>
</%block>

<%block name="js_extra">
<%include file="_js_dependencies.html" />
</%block>

<%include file="../course_navigation.html" args="active_page='discussion'" />

<section class="container">
  <div class="course-wrapper">
    <section aria-label="User Profile" class="user-profile">
      <nav>
        <%
          role_names = sorted(map(lambda x: x.name, django_user.roles.all()))
        %>
        
        <article class="sidebar-module discussion-sidebar">
          <div class="sidebar-username">${django_user.username}</div>
          <div class="sidebar-user-roles">
            ${", ".join(role_names)}
          </div>
          <div class="sidebar-threads-count"><span>${discussion_user['threads_count']}</span> ${pluralize('discussion', discussion_user['threads_count'])} started</div>
          <div class="sidebar-comments-count"><span>${discussion_user['comments_count']}</span> ${pluralize('comment', discussion_user['comments_count'])}</div>
          % if check_permissions_by_view(user, course.id, content=None, name='update_moderator_status'):
            % if "Moderator" in role_names:
              <a href="javascript:void(0)" class="sidebar-revoke-moderator-button">Revoke Moderator provileges</a>
            % else:
              <a href="javascript:void(0)" class="sidebar-promote-moderator-button">Promote to Moderator</a>
            % endif
          % endif
        </article>

      </nav>
    </section>

    <section class="course-content">
      
    </section>
  </div>
</section>
